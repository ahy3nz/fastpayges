<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Molecular Modeling Software: Open Babel</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2019-10-03T00:00:00-05:00" itemprop="datePublished">
        Oct 3, 2019
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fastpayges/categories/#molecular modeling">molecular modeling</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fastpayges/categories/#scientific computing">scientific computing</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fastpayges/categories/#grad school">grad school</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ahy3nz/fastpayges/tree/master/_notebooks/2019-10-03-openbabel1.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fastpayges/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-10-03-openbabel1.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"Open Babel is a chemical toolbox designed to speak the many languages of chemical data. It's an open, collaborative project allowing anyone to search, convert, analyze, or store data from molecular modeling, chemistry, solid-state materials, biochemistry, or related areas."</p>
<ul>
<li><a href="http://openbabel.org/wiki/Main_Page">Open Babel main page</a></li>
<li><a href="http://openbabel.org/docs/current/index.html">Open Babel overview documentation</a></li>
<li><a href="https://github.com/openbabel/openbabel">Open Babel git repo</a></li>
</ul>
<p>Open Babel is written in C++ and can be interacted with via the command line or C++ scripts, but I want to focus on the Python interface for Open Babel, <code>pybel</code></p>
<ul>
<li><a href="https://openbabel.org/docs/dev/UseTheLibrary/Python_Pybel.html">Pybel documentation</a></li>
<li><a href="https://github.com/openbabel/openbabel/blob/master/scripts/python/openbabel/pybel.py">Pybel in the repo</a></li>
</ul>
<p>Open Babel and pybel are available <a href="https://pypi.org/project/openbabel/">on pip</a> and <a href="https://anaconda.org/openbabel/openbabel">conda</a>.</p>
<p>There seems to be an <a href="https://openbabel.org/wiki/Frequently_Asked_Questions">interesting history</a> in which there was first Babel, open-sourced by others into OpenBabel, but shares some history with OELib/OEChem from OpenEye.</p>
<p>Given I'm Python-centric, I like to dabble with pybel to interface with openbabel, and see where openbabel functionality could be useful (maybe from a molecular modelling perspective).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">openbabel</span>
<span class="kn">import</span> <span class="nn">pybel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For starters, pybel provides functionality to read smiles strings, with some convenient 2D visualization within Jupyter. This is propane ($C_3H_8$).</p>
<p>Going further, openbabel <a href="http://openbabel.org/docs/current/FileFormats/Overview.html">supports a wide range of fileformats</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">molecule</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">)</span>
<span class="n">molecule</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<svg xmlns="http://www.w3.org/2000/svg" font-family="sans-serif" height="100" stroke="rgb(0,0,0)" stroke-linecap="round" stroke-width="2" viewBox="0 0 149.282 100" width="100" x="0" y="0">
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="98.0" x2="74.6" y1="53.5" y2="40.0" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="74.6" x2="51.3" y1="40.0" y2="53.5" />
<text fill="rgb(102,102,102)" font-size="16" stroke="rgb(102,102,102)" stroke-width="1" x="105.282032" y="68.000000">CH</text>
<text fill="rgb(102,102,102)" font-size="13" stroke="rgb(102,102,102)" stroke-width="1" x="129.282032" y="71.680000">3</text>
<text fill="rgb(102,102,102)" font-size="16" stroke="rgb(102,102,102)" stroke-width="1" x="14.000000" y="68.000000">H</text>
<text fill="rgb(102,102,102)" font-size="13" stroke="rgb(102,102,102)" stroke-width="1" x="26.000000" y="71.680000">3</text>
<text fill="rgb(102,102,102)" font-size="16" stroke="rgb(102,102,102)" stroke-width="1" x="32.500000" y="68.000000">C</text>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>pybel.Molecule</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Within this <code>pybel.Molecule</code> object, we can access various other data. 
Notably, we can access the underlying <code>openbabel.OBMol</code> object as defined in the C source code.
This is handled using the SWIG package, and this is our route to utilizing
openbabel functionality within python</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;openbabel.OBMol; proxy of &lt;Swig Object of type &#39;OpenBabel::OBMol *&#39; at 0x10e33e840&gt; &gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>openbabel.OBMol</code> object is immense, so I refer readers to <a href="http://openbabel.org/dev-api/classOpenBabel_1_1OBMol.shtml">the API</a> for an exhaustive list of getters, setters, and other functions relevant to molecular modelling and cheminformatics.</p>
<p>Openbabel ships with a variety of iterator objects to loop through various properties of <code>openbabel.OBMol</code> objects.
Not as pythonic as trying to generators or enumeration, but it still works</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">(),</span><span class="n">atom</span><span class="o">.</span><span class="n">GetType</span><span class="p">(),</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 C3 6
1 C3 6
2 C3 6
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we created <code>pybel.Molecule</code> out of a SMILES string, the hydrogens were implicit and ignored.
To fully enumerate this compound, we can add hydrogens</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="o">.</span><span class="n">AddHydrogens</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">molecule</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<svg xmlns="http://www.w3.org/2000/svg" font-family="sans-serif" height="100" stroke="rgb(0,0,0)" stroke-linecap="round" stroke-width="2" viewBox="0 0 214.641 194.641" width="100" x="0" y="0">
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="80.0" x2="100.0" y1="114.6" y2="80.0" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="100.0" x2="140.0" y1="80.0" y2="80.0" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="80.0" x2="80.0" y1="114.6" y2="141.6" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="80.0" x2="103.4" y1="114.6" y2="128.1" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="80.0" x2="53.0" y1="114.6" y2="114.6" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="100.0" x2="100.0" y1="80.0" y2="53.0" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="100.0" x2="76.6" y1="80.0" y2="66.5" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="140.0" x2="163.4" y1="80.0" y2="66.5" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="140.0" x2="140.0" y1="80.0" y2="53.0" />
<line stroke="rgb(0,0,0)" stroke-width="2.0" x1="140.0" x2="153.5" y1="80.0" y2="103.4" />
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="74.000000" y="162.641016">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="108.641016" y="142.641016">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="34.000000" y="122.641016">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="94.000000" y="48.000000">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="59.358984" y="68.000000">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="168.641016" y="68.000000">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="134.000000" y="48.000000">H</text>
<text fill="rgb(191,191,191)" font-size="16" stroke="rgb(191,191,191)" stroke-width="1" x="154.000000" y="122.641016">H</text>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;4}{:&lt;4}{:&lt;4}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">(),</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetType</span><span class="p">(),</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetAtomicNum</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0   C3  6   
1   C3  6   
2   C3  6   
3   H   1   
4   H   1   
5   H   1   
6   H   1   
7   H   1   
8   H   1   
9   H   1   
10  H   1   
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also iterate through the bonds in our <code>openbabel.Molecule</code> object, and even get an idea for the equilibrium bond length</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolBondIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:&lt;5}{:&lt;5}{:&lt;5}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">bond</span><span class="o">.</span><span class="n">GetBeginAtom</span><span class="p">()</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">(),</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetEndAtom</span><span class="p">()</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">(),</span> 
        <span class="n">bond</span><span class="o">.</span><span class="n">GetEquibLength</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0    1    1.52 
1    2    1.52 
0    3    1.07 
0    4    1.07 
0    5    1.07 
1    6    1.07 
1    7    1.07 
2    8    1.07 
2    9    1.07 
2    10   1.07 
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The angles</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="o">.</span><span class="n">FindAngles</span><span class="p">()</span>
<span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAngleIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(0, 1, 3)
(0, 1, 4)
(0, 1, 5)
(0, 3, 4)
(0, 3, 5)
(0, 4, 5)
(1, 0, 2)
(1, 0, 6)
(1, 0, 7)
(1, 2, 6)
(1, 2, 7)
(1, 6, 7)
(2, 1, 8)
(2, 1, 9)
(2, 1, 10)
(2, 8, 9)
(2, 8, 10)
(2, 9, 10)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And the torsions (proper dihdrals, not improper)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="o">.</span><span class="n">FindTorsions</span><span class="p">()</span>
<span class="k">for</span> <span class="n">dih</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolTorsionIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dih</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(3, 0, 1, 2)
(3, 0, 1, 6)
(3, 0, 1, 7)
(4, 0, 1, 2)
(4, 0, 1, 6)
(4, 0, 1, 7)
(5, 0, 1, 2)
(5, 0, 1, 6)
(5, 0, 1, 7)
(0, 1, 2, 8)
(0, 1, 2, 9)
(0, 1, 2, 10)
(6, 1, 2, 8)
(6, 1, 2, 9)
(6, 1, 2, 10)
(7, 1, 2, 8)
(7, 1, 2, 9)
(7, 1, 2, 10)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SMARTS-matching-within-openbabel">SMARTS matching within openbabel<a class="anchor-link" href="#SMARTS-matching-within-openbabel"> </a></h2><p>Every <code>openbabel.OBAtom</code> object has the function <a href="http://openbabel.org/dev-api/classOpenBabel_1_1OBAtom.shtml#abfdefac42d3c895920f1f715f0d710a5">MatchesSMARTS</a>.</p>
<p>Without referring to much to my earlier Foyer post, SMARTS matching helps identify atoms within a system that fit a particular SMARTS pattern (chemistry and bonding)</p>
<p>This next section will do some primitive atomtyping via SMARTS matching.</p>
<p>To start, we'll create a dictionary that relates atomtypes to their SMARTS definition (a boiled-down version of the Foyer FFXML).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smarts_definitions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;internal C&#39;</span><span class="p">:</span><span class="s1">&#39;[C;X4]([C])([C])([H])[H]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;external C&#39;</span><span class="p">:</span><span class="s1">&#39;[C;X4]([C])([H])([H])[H]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;external H&#39;</span><span class="p">:</span><span class="s1">&#39;[H][C;X4]&#39;</span><span class="p">,</span>
    <span class="s1">&#39;internal H&#39;</span><span class="p">:</span><span class="s1">&#39;[H]([C;X4]([C])([C]))&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we will iterate through all of our atoms. For each atom, we will iterate through each of our SMARTS definitions to see if there is a match</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">OBMol</span><span class="p">):</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">smarts</span> <span class="ow">in</span> <span class="n">smarts_definitions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">MatchesSMARTS</span><span class="p">(</span><span class="n">smarts</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Atom </span><span class="si">{}</span><span class="s2"> is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
            <span class="n">matched</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Atom </span><span class="si">{}</span><span class="s2"> is unmatched&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">GetIndex</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Atom 0 is external C
Atom 1 is internal C
Atom 2 is external C
Atom 3 is external H
Atom 4 is external H
Atom 5 is external H
Atom 6 is external H
Atom 6 is internal H
Atom 7 is external H
Atom 7 is internal H
Atom 8 is external H
Atom 9 is external H
Atom 10 is external H
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's also worth noting that the <a href="https://openbabel.org/wiki/SMARTS">SMARTS definitions in openbabel</a> are slightly different from SMARTS in Foyer. This isn't so surprising since scientists are always devising their own takes on SMILES and SMARTS nowadays. 
Some other key differences:</p>
<ul>
<li>Foyer can utilizes labels (when matching SMARTS patterns, we can also leverage the atoms for which we already know the atom type). The code above doesn't apply labels, nor would the SMARTS matching in openbabel know what to do with the labels. In this regard, it's helpful that Foyer has its own SMARTS matching engine</li>
<li>Foyer utilizes blacklists and whitelists to help identify multiple atom types while resolving to a singular atom type.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Force-fields">Force fields<a class="anchor-link" href="#Force-fields"> </a></h2><p>Openbabel has some support for <a href="https://github.com/openbabel/openbabel/tree/master/src/forcefields">molecular mechanics force fields</a> (GAFF, UFF, MMFF94, MM2, ghemical).</p>
<p>Within Openbabel, these basic FFs can parametrize systems and also compute forces/energies.
Some functional forms appear to include harmonic bonds, harmonic angles, periodic torsions, RB torsions, LJ nonbond interactions, harmonic impropers, and Coulombic interactions.
These various computes are defined as classes within each FF, so it's a little different from OpenMM where there are broadly classes of different force objects for different FFs to utilizes when studying a system. 
For each force class's compute method, you pass the relevant parameters and measurables, and out pops the gradient or energy.</p>
<p>From these force fields, you can generate conformers, perform energy mimization, and even run molecular dynamics (with constraints and cutoffs)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary"> </a></h2><p>Open babel is an extensive molecular modelling, cheminformatics, and bioinformatics package, and I'm sure many computational chemists/biologists would find something useful within this library. As the name "Babel" suggests, it's related to all the many various languages that split from one, original language. The Open babel library has a lot of functionality and API that a C++ or Python (or CLI) developer could utilize in their own work.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/fastpayges/molecular%20modeling/scientific%20computing/grad%20school/2019/10/03/openbabel1.html" hidden></a>
</article>