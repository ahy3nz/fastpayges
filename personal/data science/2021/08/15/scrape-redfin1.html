<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Surveying my local housing market via Redfin | fastpayges</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Surveying my local housing market via Redfin" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Fastpages-based website" />
<meta property="og:description" content="Fastpages-based website" />
<link rel="canonical" href="https://ahy3nz.github.io/fastpayges/personal/data%20science/2021/08/15/scrape-redfin1.html" />
<meta property="og:url" content="https://ahy3nz.github.io/fastpayges/personal/data%20science/2021/08/15/scrape-redfin1.html" />
<meta property="og:site_name" content="fastpayges" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-15T00:00:00-05:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://ahy3nz.github.io/fastpayges/personal/data%20science/2021/08/15/scrape-redfin1.html"},"url":"https://ahy3nz.github.io/fastpayges/personal/data%20science/2021/08/15/scrape-redfin1.html","@type":"BlogPosting","headline":"Surveying my local housing market via Redfin","dateModified":"2021-08-15T00:00:00-05:00","datePublished":"2021-08-15T00:00:00-05:00","description":"Fastpages-based website","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fastpayges/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ahy3nz.github.io/fastpayges/feed.xml" title="fastpayges" /><link rel="shortcut icon" type="image/x-icon" href="/fastpayges/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastpayges/">fastpayges</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastpayges/about/">About Me</a><a class="page-link" href="/fastpayges/credits/">Credits</a><a class="page-link" href="/fastpayges/search/">Search</a><a class="page-link" href="/fastpayges/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Surveying my local housing market via Redfin</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-08-15T00:00:00-05:00" itemprop="datePublished">
        Aug 15, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/fastpayges/categories/#personal">personal</a>
        &nbsp;
      
        <a class="category-tags-link" href="/fastpayges/categories/#data science">data science</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/ahy3nz/fastpayges/tree/master/_notebooks/2021-08-15-scrape-redfin1.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fastpayges/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-08-15-scrape-redfin1.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a somewhat practical example, getting a sense of your local housing market using some mostly-standard python libraries.
I'm particularly interested in how overpriced the homes in my area are (relative to the tax-assessed value), but you could imagine adapting this code or doing periodic data extractions to summarize some trends in your own area.</p>
<h2 id="Brief-technical-summary">Brief technical summary<a class="anchor-link" href="#Brief-technical-summary"> </a></h2><p>To anyone who might try to use this code:</p>
<ul>
<li>Start from the individual HTTP requests, then adapt those to whatever interests you</li>
<li>To download a list of home listings off redfin, <a href="https://www.redfin.com/stingray/api/gis-csv?al=1&amp;market=dc&amp;min_stories=1&amp;num_homes=350&amp;ord=redfin-recommended-asc&amp;page_number=1&amp;region_id=12839&amp;region_type=6&amp;sf=1,2,3,5,6,7&amp;status=9&amp;uipt=1,2,3,4,5,6,7,8&amp;v=8">this example URL returns a CSV file with information for each listing</a>. 
I'd actually recommend reverse engineering this URL by going on redfin, searching for a neighborhood, applying any filters, and then copying the address of the "Download all" link. I think they mention this download limits you to 350 homes, but you can see that the <code>num_homes</code> param seems changeable</li>
<li><a href="https://github.com/reteps/redfin">This redfin package provides a convenient wrapper for some commeon requests to redfin</a>. This package stores a lot of the relevant HTTP endpoints, so browse through the repo</li>
</ul>
<p>The rest of the code involves parallelization and summarizing/cleaning all the redfin requests -- it might be slightly over-engineered and overly-specific to what I'm trying to do</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">dask</span> <span class="kn">import</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">as_completed</span><span class="p">,</span> <span class="n">wait</span>
<span class="kn">from</span> <span class="nn">redfin</span> <span class="kn">import</span> <span class="n">Redfin</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define some 'constants' that will help with making requests or just filtering columns we want</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">request_headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;accept&#39;</span><span class="p">:</span> <span class="s1">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng.*/*;q=0.8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;accept-encoding&#39;</span><span class="p">:</span><span class="s1">&#39;gzip, deflate, br&#39;</span><span class="p">,</span>
    <span class="s1">&#39;accept-language&#39;</span><span class="p">:</span> <span class="s1">&#39;en-US,en;q=0.8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;upgrade-insecure-requests&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;user-agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Chrome/92.0.4515.130&#39;</span>
<span class="p">}</span>
<span class="n">relevant_columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ADDRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;CITY&#39;</span><span class="p">,</span> <span class="s1">&#39;STATE OR PROVINCE&#39;</span><span class="p">,</span> <span class="s1">&#39;ZIP OR POSTAL CODE&#39;</span><span class="p">,</span> <span class="s2">&quot;PRICE&quot;</span><span class="p">,</span> <span class="s2">&quot;tax_assessed_value&quot;</span><span class="p">,</span> <span class="s1">&#39;overpriced&#39;</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because there are a lot of houses and each request can take a while, I'm going to use <code>dask</code> to parallelize many requests.</p>
<p>Initially, I used <code>concurrent.futures</code>, but I preferred a nice visualizer UI to see the progress of my tasks. 
Also, the dask parallelization seemed <em>slightly</em> faster?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">daskclient</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">redfinclient</span> <span class="o">=</span> <span class="n">Redfin</span><span class="p">()</span>
<span class="n">daskclient</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

            <div>
                <div style="
                    width: 24px;
                    height: 24px;
                    background-color: #e1e1e1;
                    border: 3px solid #9D9D9D;
                    border-radius: 5px;
                    position: absolute;"> </div>
                <div style="margin-left: 48px;">
                    <h3 style="margin-bottom: 0px;">Client</h3>
                    <p style="color: #9D9D9D; margin-bottom: 0px;">Client-77c8f4fb-fe15-11eb-a8f9-00163e49e059</p>
                    <table style="width: 100%; text-align: left;">
                    
                <tr>
                    <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
                    <td style="text-align: left;"><strong>Cluster type:</strong> LocalCluster</td>
                </tr>
                
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard: </strong>
                        <a href="http://127.0.0.1:8787/status">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;"></td>
                </tr>
                
                    </table>
                    
                <details>
                <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
                
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
                <div style="
                    width: 24px;
                    height: 24px;
                    background-color: #e1e1e1;
                    border: 3px solid #9D9D9D;
                    border-radius: 5px;
                    position: absolute;"> </div>
                <div style="margin-left: 48px;">
                    <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
                    <p style="color: #9D9D9D; margin-bottom: 0px;">5b3fe5c0</p>
                    <table style="width: 100%; text-align: left;">
                    
            <tr>
                <td style="text-align: left;"><strong>Status:</strong> running</td>
                <td style="text-align: left;"><strong>Using processes:</strong> True</td>
            </tr>
        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"><strong>Workers:</strong> 4</td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong>
                    4
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong>
                    2.72 GiB
                </td>
            </tr>
        
                    </table>
                    <details>
                    <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Scheduler Info</h3></summary>
                    
        <div style="">
            
            <div>
                <div style="
                    width: 24px;
                    height: 24px;
                    background-color: #FFF7E5;
                    border: 3px solid #FF6132;
                    border-radius: 5px;
                    position: absolute;"> </div>
                <div style="margin-left: 48px;">
                    <h3 style="margin-bottom: 0px;">Scheduler</h3>
                    <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-d0da3455-a5cc-40c6-9d37-3ecf31796c83</p>
                    <table style="width: 100%; text-align: left;">
                        <tr>
                            <td style="text-align: left;"><strong>Comm:</strong> tcp://127.0.0.1:42703</td>
                            <td style="text-align: left;"><strong>Workers:</strong> 4</td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status">http://127.0.0.1:8787/status</a>
                            </td>
                            <td style="text-align: left;">
                                <strong>Total threads:</strong>
                                4
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Started:</strong>
                                Just now
                            </td>
                            <td style="text-align: left;">
                                <strong>Total memory:</strong>
                                2.72 GiB
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        
            <details style="margin-left: 48px;">
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Workers</h3></summary>
            
            <div style="margin-bottom: 20px;">
                <div style="width: 24px;
                            height: 24px;
                            background-color: #DBF5FF;
                            border: 3px solid #4CC9FF;
                            border-radius: 5px;
                            position: absolute;"> </div>
                <div style="margin-left: 48px;">
                <details>
                    <summary>
                        <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                    </summary>
                    <table style="width: 100%; text-align: left;">
                        <tr>
                            <td style="text-align: left;"><strong>Comm: </strong> tcp://127.0.0.1:34751</td>
                            <td style="text-align: left;"><strong>Total threads: </strong> 1</td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Dashboard: </strong>
                                <a href="http://127.0.0.1:45195/status">http://127.0.0.1:45195/status</a>
                            </td>
                            <td style="text-align: left;">
                                <strong>Memory: </strong>
                                695.89 MiB
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left;"><strong>Nanny: </strong> tcp://127.0.0.1:43271</td>
                            <td style="text-align: left;"></td>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align: left;">
                                <strong>Local directory: </strong>
                                /home/ayang41/sandbox/zillow/dask-worker-space/worker-bjq9wgap
                            </td>
                        </tr>
                        
                        
                    </table>
                </details>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="width: 24px;
                            height: 24px;
                            background-color: #DBF5FF;
                            border: 3px solid #4CC9FF;
                            border-radius: 5px;
                            position: absolute;"> </div>
                <div style="margin-left: 48px;">
                <details>
                    <summary>
                        <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                    </summary>
                    <table style="width: 100%; text-align: left;">
                        <tr>
                            <td style="text-align: left;"><strong>Comm: </strong> tcp://127.0.0.1:34411</td>
                            <td style="text-align: left;"><strong>Total threads: </strong> 1</td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Dashboard: </strong>
                                <a href="http://127.0.0.1:34047/status">http://127.0.0.1:34047/status</a>
                            </td>
                            <td style="text-align: left;">
                                <strong>Memory: </strong>
                                695.89 MiB
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left;"><strong>Nanny: </strong> tcp://127.0.0.1:41971</td>
                            <td style="text-align: left;"></td>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align: left;">
                                <strong>Local directory: </strong>
                                /home/ayang41/sandbox/zillow/dask-worker-space/worker-ns_2_qz0
                            </td>
                        </tr>
                        
                        
                    </table>
                </details>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="width: 24px;
                            height: 24px;
                            background-color: #DBF5FF;
                            border: 3px solid #4CC9FF;
                            border-radius: 5px;
                            position: absolute;"> </div>
                <div style="margin-left: 48px;">
                <details>
                    <summary>
                        <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                    </summary>
                    <table style="width: 100%; text-align: left;">
                        <tr>
                            <td style="text-align: left;"><strong>Comm: </strong> tcp://127.0.0.1:39719</td>
                            <td style="text-align: left;"><strong>Total threads: </strong> 1</td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Dashboard: </strong>
                                <a href="http://127.0.0.1:44761/status">http://127.0.0.1:44761/status</a>
                            </td>
                            <td style="text-align: left;">
                                <strong>Memory: </strong>
                                695.89 MiB
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left;"><strong>Nanny: </strong> tcp://127.0.0.1:43229</td>
                            <td style="text-align: left;"></td>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align: left;">
                                <strong>Local directory: </strong>
                                /home/ayang41/sandbox/zillow/dask-worker-space/worker-xt_76c_h
                            </td>
                        </tr>
                        
                        
                    </table>
                </details>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="width: 24px;
                            height: 24px;
                            background-color: #DBF5FF;
                            border: 3px solid #4CC9FF;
                            border-radius: 5px;
                            position: absolute;"> </div>
                <div style="margin-left: 48px;">
                <details>
                    <summary>
                        <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                    </summary>
                    <table style="width: 100%; text-align: left;">
                        <tr>
                            <td style="text-align: left;"><strong>Comm: </strong> tcp://127.0.0.1:41135</td>
                            <td style="text-align: left;"><strong>Total threads: </strong> 1</td>
                        </tr>
                        <tr>
                            <td style="text-align: left;">
                                <strong>Dashboard: </strong>
                                <a href="http://127.0.0.1:38539/status">http://127.0.0.1:38539/status</a>
                            </td>
                            <td style="text-align: left;">
                                <strong>Memory: </strong>
                                695.89 MiB
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align: left;"><strong>Nanny: </strong> tcp://127.0.0.1:40457</td>
                            <td style="text-align: left;"></td>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align: left;">
                                <strong>Local directory: </strong>
                                /home/ayang41/sandbox/zillow/dask-worker-space/worker-44tf3776
                            </td>
                        </tr>
                        
                        
                    </table>
                </details>
                </div>
            </div>
            
            </details>
        </div>
        
                    </details>
                </div>
            </div>
        
                </details>
                
                </div>
            </div>
        
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define the functions I'll be using</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">stitch_full_address</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Given a house record from redfin, generate a full address for future querying &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;ADDRESS&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CITY&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;STATE OR PROVINCE&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">process_redfin_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">redfinclient</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Given a response from redfin API, return the tax-assessed value</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This can get messy because this response is deeply-nested JSON, and </span>
<span class="sd">    there are many chances for us to fail at pulling tax values.</span>
<span class="sd">    In all the places where things can go wrong, I do a very sloppy check and </span>
<span class="sd">    then return -1 if something broke</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resp_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">4</span><span class="p">:])</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">resp_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;errorMessage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Success&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="s1">&#39;exactMatch&#39;</span> <span class="ow">in</span> <span class="n">resp_dict</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">])</span>
        <span class="p">):</span> 
            <span class="c1"># Pull property metadata</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">resp_dict</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">][</span><span class="s1">&#39;exactMatch&#39;</span><span class="p">][</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
            
            <span class="n">data</span> <span class="o">=</span> <span class="n">redfinclient</span><span class="o">.</span><span class="n">initial_info</span><span class="p">(</span><span class="n">url</span><span class="p">)[</span><span class="s1">&#39;payload&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;responseCode&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">property_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;propertyId&#39;</span><span class="p">]</span>
            <span class="n">listing_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;listingId&#39;</span><span class="p">]</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">redfinclient</span><span class="o">.</span><span class="n">below_the_fold</span><span class="p">(</span><span class="n">property_id</span><span class="p">)</span>
            <span class="c1"># Pull latest tax-assessed value</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">][</span><span class="s1">&#39;publicRecordsInfo&#39;</span><span class="p">][</span><span class="s1">&#39;allTaxInfo&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tax_assessment</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">][</span><span class="s1">&#39;publicRecordsInfo&#39;</span><span class="p">][</span><span class="s1">&#39;allTaxInfo&#39;</span><span class="p">])</span>
                    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;rollYear&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">tax_assessment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;taxableLandValue&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">tax_assessment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;taxableImprovementValue&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        

<span class="k">def</span> <span class="nf">query_redfin_dask</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">redfinclient</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; For a given address, query redfin and identify tax-assessed value</span>
<span class="sd">    </span>
<span class="sd">    This is the function we submit to the dask client</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s1">&#39;https://redfin.com/stingray/do/location-autocomplete&#39;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="n">address</span><span class="p">,</span>
            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">},</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">address</span><span class="p">:</span> <span class="n">process_redfin_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">redfinclient</span><span class="p">)}</span>


<span class="k">def</span> <span class="nf">compile_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Aggregate the results from all the redfin requests into a single series</span>
<span class="sd">    </span>
<span class="sd">    Take a list of dictionaries (from the dask future objects), flatten them into one </span>
<span class="sd">    dictionary, then turn into a pandas series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">compiled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">results</span><span class="p">)),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tax_assessed_value&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">compiled</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Download a list of all home listings from redfin based on search parameters, do some small cleaning to generate full addresses.
There might be good documentation on making this query, but there are definitely a few parameters I don't understand and only kept in here because they showed up when I searched on redfin.com and reverse-engineered the URL</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;al&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;hoa&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span>
        <span class="s1">&#39;market&#39;</span><span class="p">:</span> <span class="s1">&#39;dc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max_listing_approx_size&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span>
        <span class="s1">&#39;min_listing_approx_size&#39;</span><span class="p">:</span> <span class="mi">1700</span><span class="p">,</span>
        <span class="s1">&#39;max_num_beds&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;max_price&#39;</span><span class="p">:</span> <span class="mi">800_000</span><span class="p">,</span>
        <span class="s1">&#39;num_baths&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;num_beds&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;num_homes&#39;</span><span class="p">:</span> <span class="mi">450</span><span class="p">,</span> 
        <span class="s1">&#39;page_number&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;region_id&#39;</span><span class="p">:</span> <span class="mi">2965</span><span class="p">,</span>
        <span class="s1">&#39;region_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s1">&#39;sf&#39;</span><span class="p">:</span> <span class="s1">&#39;1,2,3,5,6,7&#39;</span><span class="p">,</span>
        <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
        <span class="s1">&#39;uipt&#39;</span><span class="p">:</span> <span class="s1">&#39;1,2,3,4,5,6,7,8&#39;</span><span class="p">,</span>
        <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">8</span>
    <span class="p">}</span>
    <span class="n">download</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s1">&#39;https://www.redfin.com/stingray/api/gis-csv?&#39;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">request_headers</span>
    <span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">download</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">full_address</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">stitch_full_address</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each home listing, download more-detailed information pertaining to the taxable land value and taxable improvement value.
There's certainly a lot of other information you could pull from these queries, but I'll leave that as an exercise to the reader</p>
<p>This is technically broken into some different dask steps to scatter the <code>requests.Session</code> and <code>redfin.Client</code> objects, and then making a bunch of queries (with <code>dask.delayed</code> objects) to redfin for each particular address</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="n">session_scattered</span> <span class="o">=</span> <span class="n">daskclient</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
    <span class="n">redfinclient_scattered</span> <span class="o">=</span> <span class="n">daskclient</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">redfinclient</span><span class="p">)</span>
    <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">delayed</span><span class="p">(</span><span class="n">query_redfin_dask</span><span class="p">)(</span><span class="n">session_scattered</span><span class="p">,</span> <span class="n">redfinclient_scattered</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">request_headers</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;full_address&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">futures</span> <span class="o">=</span> <span class="n">daskclient</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span> 
    <span class="n">completed_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">raise_errors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Join the tax-assessed values back to the original dataframe, compute how overpriced the property is</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">processed_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">compile_results</span><span class="p">(</span><span class="n">completed_results</span><span class="p">),</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;full_address&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">overpriced</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;tax_assessed_value&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examine results, some information is masked</p>
<p>In this particular example, some homes have really low tax-assessed values relative to actual price.
I think this is because these homes are so new (built in this year) that there's no taxableImprovementValue yet, only taxableLandValue.
As a result, these newly-built properties can appear extremely overpriced</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span>
    <span class="n">processed_df</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tax_assessed_value &gt; 0&#39;</span><span class="p">)</span>
    <span class="p">[</span><span class="n">relevant_columns</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;overpriced&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
        <span class="s1">&#39;ADDRESS&#39;</span><span class="p">:</span> <span class="s1">&#39;SORRY&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CITY&#39;</span><span class="p">:</span> <span class="s1">&#39;I AM&#39;</span><span class="p">,</span>
        <span class="s1">&#39;STATE OR PROVINCE&#39;</span><span class="p">:</span> <span class="s2">&quot;MASKING&quot;</span><span class="p">,</span>
        <span class="s1">&#39;ZIP OR POSTAL CODE&#39;</span><span class="p">:</span> <span class="s2">&quot;THESE COLUMNS&quot;</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ADDRESS</th>
      <th>CITY</th>
      <th>STATE OR PROVINCE</th>
      <th>ZIP OR POSTAL CODE</th>
      <th>PRICE</th>
      <th>tax_assessed_value</th>
      <th>overpriced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>450000</td>
      <td>493760.0</td>
      <td>-43760.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>484950</td>
      <td>483150.0</td>
      <td>1800.0</td>
    </tr>
    <tr>
      <th>325</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>535000</td>
      <td>532130.0</td>
      <td>2870.0</td>
    </tr>
    <tr>
      <th>78</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>650000</td>
      <td>642130.0</td>
      <td>7870.0</td>
    </tr>
    <tr>
      <th>135</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>570000</td>
      <td>560410.0</td>
      <td>9590.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>376</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>681950</td>
      <td>190000.0</td>
      <td>491950.0</td>
    </tr>
    <tr>
      <th>375</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>684950</td>
      <td>190000.0</td>
      <td>494950.0</td>
    </tr>
    <tr>
      <th>337</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>688950</td>
      <td>190000.0</td>
      <td>498950.0</td>
    </tr>
    <tr>
      <th>359</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>740950</td>
      <td>190000.0</td>
      <td>550950.0</td>
    </tr>
    <tr>
      <th>360</th>
      <td>SORRY</td>
      <td>I AM</td>
      <td>MASKING</td>
      <td>THESE COLUMNS</td>
      <td>790950</td>
      <td>190000.0</td>
      <td>600950.0</td>
    </tr>
  </tbody>
</table>
<p>341 rows Ã— 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Basic statistics to summarize <em>over our particular housing sample</em></p>
<ul>
<li>Raw price values are skewed because of the filters I imposed when pulling the entier list of homes-for-sale from redfin</li>
<li>Look only at the homes for which I could succesfully identify the tax-assessed value</li>
<li>Look only at the homes that don't seem extremely overpriced. Homes that are extremely overpriced might just be due to the absence of taxableImprovementValue from new builds.</li>
<li>In the end, this is roughly the set of homes I'm interested in, so I can still continue with finding tax assessed values and evaluating how overpriced they are</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span>
    <span class="n">processed_df</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tax_assessed_value &gt; 0 &amp; overpriced &lt; 200000&#39;</span><span class="p">)</span>
    <span class="p">[[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">,</span> <span class="s1">&#39;tax_assessed_value&#39;</span><span class="p">,</span> <span class="s1">&#39;overpriced&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PRICE</th>
      <th>tax_assessed_value</th>
      <th>overpriced</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>325.000000</td>
      <td>325.000000</td>
      <td>325.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>632634.787692</td>
      <td>538761.950769</td>
      <td>93872.836923</td>
    </tr>
    <tr>
      <th>std</th>
      <td>98730.374007</td>
      <td>84934.788980</td>
      <td>41077.668809</td>
    </tr>
    <tr>
      <th>min</th>
      <td>409000.000000</td>
      <td>329660.000000</td>
      <td>-43760.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>550000.000000</td>
      <td>475990.000000</td>
      <td>66000.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>639500.000000</td>
      <td>534280.000000</td>
      <td>89140.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>700000.000000</td>
      <td>603570.000000</td>
      <td>121590.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>800000.000000</td>
      <td>766600.000000</td>
      <td>195260.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Roadbumps">Roadbumps<a class="anchor-link" href="#Roadbumps"> </a></h2><p>I initially looked into zillow and <code>pyzillow</code>, but some of those libraries seemed poorly documented or out-of-date, so I ran into some difficulty using those.
Redfin conveniently dumps <a href="https://www.redfin.com/news/data-center/">summaries of some metro areas</a>, but these are 1-2 months lagged behind, which is not super helpful to anyone in a buying mood.
Basically, for any coding hobbyist wanting to do some useful data science, the API-makers have made it difficult</p>
<h2 id="Final-thoughts">Final thoughts<a class="anchor-link" href="#Final-thoughts"> </a></h2><p>No fancy statistics or modeling, just pulling together some pydata tools to scrape redfin and summarize some data that might be useful to me in the future</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/fastpayges/personal/data%20science/2021/08/15/scrape-redfin1.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastpayges/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://ahy3nz.github.io/fastpayges/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fastpayges/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Fastpages-based website</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/ahy3nz" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/fastpayges/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
